<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- CSS only -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">
  <!-- JavaScript Bundle with Popper -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-A3rJD856KowSb7dwlZdYEkO39Gagi7vIsF0jrRAoQmDKKtQBHUuLZ9AsSv4jD4Xa" crossorigin="anonymous"></script>
  <title>Document</title>
  <script>
    window.onload = function() {
      function getUserList() {
        fetch("https://jsonplaceholder.typicode.com/users")
            .then(response=> response.json())
            .then(json=> displayUserList(json))
            .catch(error=>console.log(error));
      }
      function displayUserList(userList){
        let userListBody = document.querySelector("#userList");
        userListBody.innerHTML = "";
        // <tr><td></td><tr>
        for (const user of userList){
          let tr = document.createElement("tr");
          let content = "";
          tr.setAttribute("data-userid",user.id);
          tr.addEventListener("click",getPosts);
          content = `<td>${user.id}</td>`;
          content += `<td>${user.name}</td>`;
          content += `<td>${user.phone}</td>`;
          content += `<td>${user.website}</td>`;
          tr.innerHTML = content;
          userListBody.appendChild(tr);
        }
      }
      function getPosts() {
        let userId = this.getAttribute('data-userid');
        fetch(`https://jsonplaceholder.typicode.com/users/${userId}/posts`)
            .then(response=> response.json())
            .then(json=> displayPostList(json))
            .catch(error=>console.log(error));
      }
      function displayPostList(posts) {
        let postListBody = document.querySelector("#postList");

        postListBody.innerHTML = "";
        for (const post of posts) {
          let tr = document.createElement("tr");
          let content = `<td>${post.userId}</td>`;
          content += `<td>${post.title}</td>`;
          content += `<td>${post.body}</td>`;
          tr.innerHTML = content;
          postListBody.appendChild(tr);
        }
      }
      document.querySelector("#listBtn").addEventListener("click",getUserList);
    }
  </script>
</head>
<body>
  <div class="container">

    <div class="row">
      <button id="listBtn" class="btn btn-primary">사용자 정보 불러오기</button>
    </div>
    <div class="row">
      <table class="table table-striped table-hover">
        <thead>
          <tr>
            <th>아이디</th>
            <th>이름</th>
            <th>전화번호</th>
            <th>홈페이지</th>
          </tr>
        </thead>
        <tbody id="userList">
          <tr class="text-center" colspan="4">사용자 정보를 조회해 주세요!</tr>
        </tbody>
      </table>
    </div>
    <div class="row">
      <table class="table">
        <thead>
          <tr>
            <th class="col-md-2">작성자 아이디</th>
            <th class="col-md-4">제목</th>
            <th class="col-md-6">내용</th>
          </tr>
        </thead>
        <tbody id="postList"></tbody>
      </table>
    </div>
  </div>
</body>
</html>